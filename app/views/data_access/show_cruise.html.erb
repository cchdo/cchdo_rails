<% unless @cruise -%>

  <div class="boxed">
  <h1>Cruise not found</h1>
  <div class="box_content">
    <p>Cruise <%=params[:ExpoCode] %> does not exist.</p>
  </div>
  <div class="box_bottom"></div>
  </div>

<% else -%>

<div class="data_access">
<%- updates_available = !(@queue_files.blank? and @merged_queue_files.blank?) %>
<div class="information left">

<%# General Information and Files column %>
<div id="general" class="boxed">
<h1>Cruise Information</h1>
<div class="box_content">

<% if big = @file_result['big_pic'] and big != 0 and
      small = @file_result['small_pic'] and small != 0 %>
  <div class="thumb">
    <a href="<%=big%>"><p><img src="<%=small%>"></p><p class="caption">Full Size</p></a>
  </div>
<% end %>
<p><strong>ExpoCode:</strong> <%= @cruise.ExpoCode %></p>
<p><strong>Line:</strong> <%= @cruise.Line %></p>
<% if @cruise.Alias and @cruise.Alias =~/\w/ %>
  <p><strong>Alias:</strong> <%= @cruise.Alias %></p>
<% end %>
<p><strong>Ship/Country:</strong> <%=self_or_empty(@cruise.Ship_Name)%>/<%=self_or_empty(@cruise.Country)%></p>
<p><strong>Chief Scientists:</strong> <%=self_or_empty(@cruise.Chief_Scientist)%></p>
<p><strong>Cruise Dates:</strong> <%= pretty_dates(@cruise) %></p>
<% if @cruise.link %>
  <p><strong>Expedition Link:</strong> <%= link_to(@cruise.link, @cruise.link) %></p>
<% end %>

</div>
<div class="box_bottom"></div>
</div>

<div id="data" class="boxed">
<h1>Dataset</h1>
<div class="box_content">

<%=content_tag(:p, @preliminary, :class => "preliminary important") if @preliminary -%>

<%
file_sections = [
  [:Exchange,
    [
      ['exchange_ctd', ['CTD', 'ZIP archive of ASCII .csv CTD data with station information']],
      ['exchange_bot', ['BOT', 'ASCII .csv bottle data with station information']],
      ['exchange_large_volume', ['Large Volume', 'ASCII .csv bottle data with station information']],
      ['trace_metal', ['Trace Metals', 'ASCII .csv trace metal data with station information']],
    ]
  ],
  [:NetCDF,
    [
      ['netcdf_ctd', ['CTD', 'ZIP archive of binary CTD data with station information']],
      ['netcdf_bot', ['BOT', 'Binary bottle data with station information']],
    ]
  ],
  [:WOCE,
    [
      ['woce_sum', ['SUM', 'ASCII station/cast information']],
      ['woce_ctd', ['CTD', 'ASCII CTD data without station information']],
      ['woce_bot', ['BOT', 'ASCII bottle data without station information']],
      ['large_volume', ['Large Volume', 'ASCII bottle data without station information']],
    ]
  ],
  [:Documentation,
    [
      ['text_doc', ['Text', 'ASCII cruise and data documentation']],
      ['pdf_doc', ['PDF', 'Portable Document Format cruise and data information']],
    ]
  ]
]
-%>

<% for section, filetypes in file_sections -%>
  <%=content_tag(:h2, section)-%>
  <% for type, display in filetypes -%>
    <% if file = @file_result[type] and file != 0 -%>
      <p><%=link_to(display[0], file)%> - <%=display[1]-%></p>
    <% end -%>
  <% end -%>
<% end -%>
  
</div>
<div class="box_bottom"></div>
</div>
<%# End Data Info and Files column -%>
</div>

<%= render :partial => 'cruise_data_updates' %>

<div class="clear"></div>
<%= render :partial => 'cruise_data_history' %>
</div>

</div>
<% end -%>
